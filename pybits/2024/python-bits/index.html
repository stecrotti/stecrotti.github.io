<!DOCTYPE html> <html> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>Python bits | Stefano Crotti</title> <meta name="author" content="Stefano Crotti"> <meta name="description" content="PhD candidate in Physics "> <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-DF7Zhf293AJxJNTmh5zhoYYIMs2oXitRfBjY+9L//AY=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css" integrity="sha256-mUZM63G8m73Mcidfrv5E+Y61y7a12O5mW4ezU3bxqW4=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha256-i1+4qU2G2860dGGIOJscdC30s9beBXjFfzjWLjBRsBg=" crossorigin="anonymous"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/github.css" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%F0%9F%8D%A4&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css"> <link rel="canonical" href="https://stecrotti.github.io/pybits/2024/python-bits/"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/native.css" media="none" id="highlight_theme_dark"> <script src="/assets/js/theme.js"></script> <script src="/assets/js/dark_mode.js"></script> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script src="/assets/js/distillpub/template.v2.js"></script> <script src="/assets/js/distillpub/transforms.v2.js"></script> <script src="/assets/js/distillpub/overrides.js"></script> </head> <body> <d-front-matter> <script async type="text/json">{
      "title": "Python bits",
      "description": "",
      "published": "September 22, 2024",
      "authors": [
        
      ],
      "katex": {
        "delimiters": [
          {
            "left": "$",
            "right": "$",
            "display": false
          },
          {
            "left": "$$",
            "right": "$$",
            "display": true
          }
        ]
      }
    }</script> </d-front-matter> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"><span class="font-weight-bold">Stefano </span>Crotti</a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">About</a> </li> <li class="nav-item "> <a class="nav-link" href="/blog/">PyBits</a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">Publications</a> </li> <li class="nav-item "> <a class="nav-link" href="/notes/">Notes</a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">CV</a> </li> <li class="nav-item "> <a class="nav-link" href="/Links/">Links</a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fas fa-moon"></i> <i class="fas fa-sun"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="post distill"> <d-title> <h1>Python bits</h1> <p></p> </d-title> <d-byline></d-byline> <d-article> <h2 id="performance">Performance</h2> <h3 id="vectorized-operations">Vectorized operations</h3> <p>Vectorized operations are quicker than loops in Python. That’s because loops are executed in Python, while vectorized operations done by NumPy call C routines under the hood, and C is overwhelmingly faster than Python</p> <h2 id="misc">Misc</h2> <h3 id="indexing">Indexing</h3> <p>Python’s way of indexing vectors is weird coming from Julia, but look at this: to split a list l before and after index i, you just do <code class="language-plaintext highlighter-rouge">before=l[:i]; after=l[i:]</code>.</p> <h3 id="dynamic-addition-of-attributes">Dynamic addition of attributes</h3> <p>Turns out in Python you can add attributes to an object at runtime, attributes that were not in the class definition! Things like <code class="language-plaintext highlighter-rouge">obj.new_attribute = 3</code>. It sounds pretty dangerous to me, but ok.</p> <h3 id="functors">Functors</h3> <p>Adding a <code class="language-plaintext highlighter-rouge">__call__</code> method to a class will enable instances to behave as functions. This is what is called “functor” behavior in Julia.</p> <h3 id="context-manager">Context manager</h3> <p>A context manager is a Python construct that calls <code class="language-plaintext highlighter-rouge">__enter__</code> when the object is created in a <code class="language-plaintext highlighter-rouge">with</code> clause, and <code class="language-plaintext highlighter-rouge">__exit__</code> at the end of the with clause. For instance, this is how Python handles the with <code class="language-plaintext highlighter-rouge">open(...) as f</code>: construct that you’ll often see for opening files without requiring an explicit <code class="language-plaintext highlighter-rouge">close(f)</code> at the end.</p> <h3 id="generators-and-iterators">Generators and iterators</h3> <p>Generators in Python are iterators, just like those in Julia, i.e. lazy iterators over iterables, except in Python once you can’t iterate more than once. Iterating a second time returns nothing</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&gt;&gt;&gt; mygenerator = (x*x for x in range(3))
&gt;&gt;&gt; for i in mygenerator:
...    print(i)
0
1
4
&gt;&gt;&gt; for i in mygenerator:
...    print(i)
</code></pre></div></div> <p>Python iterators are stateful, meaning that an iterator is an object containing a state which is modified every time an iteration is performed. Instead, Julia’s <a href="https://docs.julialang.org/en/v1/base/collections/#Base.iterate" rel="external nofollow noopener" target="_blank"><code class="language-plaintext highlighter-rouge">iterate</code></a> accepts an iterator and a state, and returns a <code class="language-plaintext highlighter-rouge">(item , newstate)</code> tuple.</p> <p>In Python, iterators are managed using the <a href="https://www.geeksforgeeks.org/use-yield-keyword-instead-return-keyword-python/" rel="external nofollow noopener" target="_blank"><code class="language-plaintext highlighter-rouge">yield</code></a> keyword. Placed instead of a <code class="language-plaintext highlighter-rouge">return</code> statement, it transforms the return of the parent function into an iterator which, once iterated over, executes the code until the next <code class="language-plaintext highlighter-rouge">yield</code> statement. Automatically, enough information is stored in the iterator object such that it’s possible to resume execution at each iteration.</p> <p>Python comes with an <code class="language-plaintext highlighter-rouge">itertools</code> standard library. For example, <code class="language-plaintext highlighter-rouge">itertools.islice</code> is very similar to Julia’s <code class="language-plaintext highlighter-rouge">Iterators.take</code>.</p> <h3 id="file-explorer">File explorer</h3> <p><code class="language-plaintext highlighter-rouge">os.walk</code>: generates the file names in a directory tree by walking the tree either top-down or bottom-up. For each directory in the tree rooted at directory top (including top itself), it yields a 3-tuple (dirpath, dirnames, filenames).</p> <h3 id="the-pass-keyword">The <code class="language-plaintext highlighter-rouge">pass</code> keyword</h3> <p>It’s used as a “do nothing” operation in places where Python does not allow an empty space, e.g. class or function definitions, thus avoiding the raising of errors. It can be useful to define the skeleton of a program before actually filling in all the details, or in places where one knows there will be code in the future.</p> <h2 id="comparisons-with-julia">Comparisons with Julia</h2> <h3 id="closures">Closures</h3> <p><code class="language-plaintext highlighter-rouge">partial</code> is Python’s equivalent of a closure in Julia.</p> <h2 id="decorators">Decorators</h2> <p>Like Julia macros, decorators take a piece of code as input and return a modified version of it to be executed (metaprogramming). As an example, recall the <a href="https://www.fast.ai/posts/2019-08-06-delegation.html" rel="external nofollow noopener" target="_blank">discussion on delegation</a>.</p> <h3 id="import-of-decorator">Import of decorator</h3> <p>To import a decorator, you need to specify it without the “at” (@) at the beginning (not really sure why)</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="n">numba</span> <span class="kn">import</span> <span class="n">njit</span>
<span class="nd">@njit</span>
<span class="n">do</span> <span class="n">stuff</span> <span class="bp">...</span>
</code></pre></div></div> <h2 id="numba">Numba</h2> <p><a href="https://numba.pydata.org/" rel="external nofollow noopener" target="_blank">Numba</a> is a library for compiling python code to machine code once, then running the fast version every time the function is called. Just like what happens all the time with Julia!</p> </d-article> <d-appendix> <d-footnote-list></d-footnote-list> <d-citation-list></d-citation-list> </d-appendix> <d-bibliography src="/assets/bibliography/"></d-bibliography> </div> <footer class="fixed-bottom"> <div class="container mt-0"> © Copyright 2025 Stefano Crotti. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. Last updated: January 06, 2025. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js" integrity="sha256-fgLAgv7fyCGopR/gBNq2iW3ZKIdqIcyshnUULC4vex8=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>